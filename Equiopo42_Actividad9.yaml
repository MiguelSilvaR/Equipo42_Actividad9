openapi: 3.0.3

info:
  title: Smart Meeting Assistant API
  version: "1.0.0"
  description: >
    API del Smart Meeting Assistant (SMA). Permite registrar usuarios, proponer
    reuniones, administrar participantes, almacenar resúmenes y generar tareas
    de seguimiento.
  contact:
    name: |
      Equipo 42
      Miguel Silva Ramos - A01328387
      José Montante - A01150895
      Hector Jorge Morales Arch - A01796487
      Carlos Del Castillo Rey - A01796595

servers:
  - url: https://firestore.googleapis.com/v1/projects/smart-meeting-assistant-1a3c8/databases/(default)/documents/
    description: Entorno principal (simulado)

tags:
  - name: Usuarios
    description: Operaciones relacionadas con usuarios registrados
  - name: Reuniones
    description: Gestión de reuniones y tareas
  - name: Disponibilidad
    description: Sugerencias de horarios comunes
  - name: Sistema
    description: Estado del servicio

externalDocs:
  description: Documentación técnica del proyecto
  url: https://github.com/equipo42/sma-docs

security:
  - ApiKeyAuth: []
  - BearerAuth: []

paths:

  /health:
    get:
      tags:
        - Sistema
      summary: Verificar estado del servicio
      description: Retorna 200 si el servicio está activo.
      responses:
        "200":
          description: OK
        "503":
          description: Servicio no disponible

  /users:
    get:
      tags: [Usuarios]
      summary: Listar usuarios conocidos
      parameters:
        - in: query
          name: email
          schema:
            type: string
          description: Filtrar por email exacto.
      responses:
        "200":
          description: Lista de usuarios
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/User"
        "400":
          description: Parámetros inválidos
    post:
      tags: [Usuarios]
      summary: Crear usuario
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/User"
      responses:
        "201":
          description: Usuario creado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
        "400":
          description: Datos incompletos o inválidos

  /users/{userId}:
    get:
      tags: [Usuarios]
      summary: Obtener detalle de usuario
      parameters:
        - in: path
          name: userId
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Usuario encontrado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
        "404":
          description: Usuario no encontrado
    patch:
      tags: [Usuarios]
      summary: Actualizar usuario
      parameters:
        - in: path
          name: userId
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/User"
      responses:
        "200":
          description: Usuario actualizado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
        "400":
          description: Datos inválidos
        "404":
          description: Usuario no encontrado

  /meetings:
    get:
      tags: [Reuniones]
      summary: Listar reuniones
      parameters:
        - in: query
          name: from
          schema:
            type: string
            format: date-time
        - in: query
          name: to
          schema:
            type: string
            format: date-time
        - in: query
          name: organizerId
          schema:
            type: string
      responses:
        "200":
          description: Lista de reuniones
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Meeting"
        "400":
          description: Parámetros inválidos
    post:
      tags: [Reuniones]
      summary: Crear reunión
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Meeting"
      responses:
        "201":
          description: Reunión creada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Meeting"
        "400":
          description: Datos inválidos

  /meetings/{meetingId}:
    get:
      tags: [Reuniones]
      summary: Obtener detalles de una reunión
      parameters:
        - in: path
          name: meetingId
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Reunión encontrada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Meeting"
        "404":
          description: Reunión no encontrada
    patch:
      tags: [Reuniones]
      summary: Actualizar reunión
      parameters:
        - in: path
          name: meetingId
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Meeting"
      responses:
        "200":
          description: Reunión actualizada
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Meeting"
        "400":
          description: Datos inválidos
        "404":
          description: Reunión no encontrada
    delete:
      tags: [Reuniones]
      summary: Cancelar reunión
      parameters:
        - in: path
          name: meetingId
          required: true
          schema:
            type: string
      responses:
        "204":
          description: Reunión cancelada
        "404":
          description: Reunión no encontrada

  /meetings/{meetingId}/summary:
    post:
      tags: [Reuniones]
      summary: Guardar resumen de la reunión
      parameters:
        - in: path
          name: meetingId
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                summaryText:
                  type: string
              required:
                - summaryText
      responses:
        "200":
          description: Resumen guardado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Meeting"
        "404":
          description: Reunión no encontrada

  /meetings/{meetingId}/action-items:
    get:
      tags: [Reuniones]
      summary: Listar action items de una reunión
      parameters:
        - in: path
          name: meetingId
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Lista de action items
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Task"
        "404":
          description: Reunión no encontrada
    post:
      tags: [Reuniones]
      summary: Crear action item en una reunión
      parameters:
        - in: path
          name: meetingId
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Task"
      responses:
        "201":
          description: Action item creado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Task"
        "400":
          description: Datos inválidos
        "404":
          description: Reunión no encontrada

  /availability/suggest:
    post:
      tags: [Disponibilidad]
      summary: Proponer horarios disponibles
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AvailabilityRequest"
      responses:
        "200":
          description: Slots sugeridos
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/AvailabilitySuggestion"
        "400":
          description: Datos inválidos

components:
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-Key
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:

    User:
      type: object
      properties:
        id:
          type: string
          format: uuid
          example: "123e4567-e89b-12d3-a456-426614174000"
        displayName:
          type: string
          example: "Karla López"
